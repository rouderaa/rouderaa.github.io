<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>

  <meta charset="UTF-8" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>The RoboPi Blog</title>


  <style>
body {
font-family: Arial, sans-serif;
margin: 0;
padding: 0;
}
header {
text-align: center;
padding: 20px;
}
.container {
max-width: 800px;
margin: 0 auto;
padding: 20px;
}
.blog-entry {
border: 1px solid #ddd;
padding: 20px;
margin-bottom: 20px;
}
.blog-entry h2 {
font-weight: bold;
}
/* Center the logo horizontally */
.logo {
display: block;
margin: 0 auto;
}
#rotateImage {
transform: rotate(360deg); /* Rotate the image by 45 degrees */
}
  </style>
</head>


<body>

<header>
<img src="images/robopilogo.png" alt="RoboPi Logo" class="logo" style="width: 227px; height: 227px;" /></header>
<div class="container">
<div class="blog-entry">
<h2>These are the trials and tribulations of making my little
robot cart RoboPi.</h2>

<p>I want to take part in the PiWars challenges and challenges
indeed they are.</p>

</div>

<div class="blog-entry">
<h2>The team</h2>
<p>
The robopi team consists of two robot enthusiasts, Kees and Rob. Both are members of the 'HCC robotica' hobby club, which is Dutch for the robotics group.
There is a monthly gathering of this robotics group right in the centre of the Netherlands in the city of Amersfoort of people fascinated with building their own robots. This a nice time to meet others and exchange stories and the current challenges that we always face when there is something to do with robotics. Never a dull moment.
</p></div>
<div class="blog-entry">
<h2>Choices, choices, choices</h2>

<p>So well what is this cart going to look like? It depends on what
it should be able to do. So reading the website of PiWars was the place
to start. After reading and pondering it looks like that speed is
important and image recognition. We want to see different kinds of
colored objects like barrels, zombies, and colored locations. So a
camera is needed. Since we also want to turn corners and follow lines,
we need to be able to steer the robot. Also, it would be nice if we can
detect walls. We also need to be able to navigate a route without the
help of a line. Finding out the distance to a wall would also be very
handy to prevent the robot from bumping into it. Maybe even our little
robot should be able to grab a barrel and even fire a little cannon. So
the option to add some components for a specific challenge is the way
to go. With all this, we have the hardware, mechanics, electronics, and
software to consider.</p>

<p>It would be nice if we can use a lot of open source and
available stuff.</p>

</div>

<div class="blog-entry">
<h2>The base</h2>

<p>Our little robot has to carry batteries, a camera, some
computer, and other stuff. So it should not be too little but also not
too large, just right. The base that seems to fit the bill is this
thing.</p>

<img style="height: 429px; width: 535px;" src="./images/base.png" alt="Base Image" />
</div>

<div class="blog-entry">
<h2>Dust is the enemy</h2>

<p>The encoders of the motors have no protection and are very
close to the
ground. In order to protect them against the dust and dirt of the
disaster world, we need to protect them.&nbsp;</p>

<p><br />

<img style="height: 429px; width: 535px;" src="./images/nodustcovermotor.JPG" alt="No dust cover motor" />
</p>

<p>This is much better</p>

<img style="height: 429px; width: 535px;" src="./images/dustcovermotor.JPG" alt="Dust cover motor" />
</div>

<div class="blog-entry">
<h2>Attaching the main parts</h2>

<p>First things to do is to attach parts to the base of the robot
like the battery holder, some pcb to experiment on, add an arduino uno
with motor speed controll and so on.</p>

<img src="./images/IMG_0138.JPG" alt="Base Image" id="rotateImage" style="width: 429px; height: 535px;" />
</div>

<div class="blog-entry">
<h2>Lets add the rpi4 and camera with a frame</h2>

<p>The raspberry pi 4 will go to the front of the robot. I made a
3d design for it and also a place for the camera</p>

<img style="height: 429px; width: 535px;" src="./images/IMG_0149.JPG" alt="Base Image" />
<p>The time of flight sensors are at the front and two on the
side. In the past I found that these sensors can be troubled by ir
light so I added a sun protection cone to each one of them.</p>

</div>

<div class="blog-entry">
<h2>Yikes, spikes!</h2>

<p>The RoboPi robot has an orientation sensor onboard, the chip
BNO055. A great chip but now something weird was happening. When
rotating the robot at random times, huge spikes appeared in the z-angle
that we are interested in. After much pondering and trying another
driver, still no luck. So time for plan B. By using a median filter, we
can filter out these random spikes, and now the trace of the
orientation shows a smooth curve for the z-angle. Happy days, on to the
next challenge.</p>

</div>

<div class="blog-entry">
<h2>Wireless access to my robopi robot</h2>

<p>A very nice luxury is the abality to access the desktop of the
raspberry pi 4 of the robot from my laptop using wifi.
After some fidling and reading internet pages about this, the robopi
robot now is a wifi access point that I can use from my laptop. Happy
days.</p>

</div>

<div class="blog-entry">
<h2>We need a cannon !</h2>

<p>To beat those pescy zombies we need a cannon ! Luckely there
was a great design on thingiverse.com of Markus Purtz that I could
adjust. Now the canon is starting to look like one.
</p>

<img style="height: 429px; width: 535px;" src="./images/canon1.JPG" alt="Canon building 1" />
<p>Two brushless motors will drive the nerf dart to the zombie. A
servo pushes the dart from a cartridge to the barrel and there is
another to tilt the canon so we can aim for zombies higher up.
</p>

</div>

<div class="blog-entry">
<h2>That cannon needs a base (first try)</h2>

<p>The big canon needs a sturdy base on the robot to stand on.
The first attempt from my 3d printed design turned out not quite
right...
</p>

<img style="height: 429px; width: 535px;" src="./images/IMG_0179.JPG" alt="Canon base attempt" />
<p>So back to the drawing board with a more modular design of the
base that can be printed in several parts and then assembled using
bolts.</p>

</div>

<div class="blog-entry">
<h2>That cannon needs a better base (second try)</h2>

<p>Measurements of the holes for the base were wrong (duh).
Measured again, twice, now should be good.
</p>

<img src="./images/IMG_0181.JPG" alt="Canon base attempt 2" />
<p>Now in red and even seems to fit on the chassis, life is good.
Changed the way the poles are attached to the main frame with a bolt
and screw attach.</p>
</div>

<div class="blog-entry">
<h2>Smoke signals are not ok</h2>

<p>If your hardware gives out smoke signals, that is not good
:-).
Looks like the motor driver is gone because of a software error with
PWM I was not anticipating.
A well, luckly there are two motor drivers on the bord, need to fire up
my soldering iron to fix this. Turns out that did not work because also
the second motor driver got toasted somehow.
I found a electronic speed controller I can use and added that to the
robot. The disadvantage is that now I can only control
the speed of the two motors by one controller. So no differential speed
is possible but the steering front should be enough I expect.
</p>

</div>

<div class="blog-entry">
<h2>A laser pointer on the barrel</h2>

<p>To find out where the cannon is pointing to I added a small
laser pointer diode.
It is controlled by the Arduino uno and so controllable by software.
Made a small bracket that clamps to the barrel.
Probably needs some super glue but it is ok for now.
</p>

</div>

<div class="blog-entry">
<h2>Balloons, balloons ...</h2>

<p>At pi-noon all robots gather around to burst balloons. To practice this art it would be nice if our robot could have a platform to attach the balloons to.
Some looking around on the piwars website revealed a svg file with the current design using a laser cutter. Unfortunately I do not have this nice apparatus 
but I do have a 3D printer. Some designing in freecad later led to this contraption.
</p>
<img style="height: 429px; width: 535px;" src="./images/IMG_0208.JPG" alt="Balloon platform" />
<p>
The design is free to use for all at <a href="https://www.thingiverse.com/thing:6277677">piwars balloon platform</a> .
</p>
</div>

<div class="blog-entry">
<h2>Driving like an egyptian</h2>

<p>To start our little robot moving in some sort of controllable way the first task is to make sure it can drive in a straight line.
Since the motors of the robot are not exactly equal there will be some tendency to drive to the left or right.
To fix this we can use the gyroscope implemented by the bno055 chip on the robot. This thing knows the angle it is at and if we make sure that we use the steering correctly we can strive to stay on a specific angle. If the chip says we are to the left then the steering needs to go to the right and the other way around as well.
Let the experiments begin to see if this theory conforms to the reality. 
</p>
<img style="height: 512px; width: 512px;" src="./images/robotsInLine.png" alt="Robots in line" />
<p>
This is challenging, we also need to take into account that if driving backwards the angles need to reverse. Also setting the north position is non trivial.
The gyroscope is set to its initial 'north' at powerup. What we need to do is set a new 'north' if the robopi robot is on the floor and at the start of the track.
In the end this comes down to doing some trigonometry with substracting one angle being the gyroscope 'north' from the angle of the 'north' required on the track.
Now we need to test, test and test again.
</p>
<img style="height: 512px; width: 512px;" src="./images/Yaw_Axis_Corrected.png" alt="Robots in line" />
</div>
<div class="blog-entry">
<h2>Attaching stuff</h2>
<p>At the front of our little robot we need to be able to attach stuff. Stuff like the jousting pin to burst balloons or a grabber arm that can grab a barrel in the field. In order to allow for some sturdy but flexible attachment, Kees designed a nice holder in a wood prototype. 
</p>
<img style="height: 512px; width: 512px;" src="./images/woodenProtoWithInsert.jpg" alt="Wood prototype attachment" />
<p>Then came the first 3D version. You always need at least two version to get it right. This time the first version did not print very easyly. The supports would not come off so I designed a second version that dit not need supports.
<p>
<img style="height: 512px; width: 512px;" src="./images/3dInsertFirst.jpg" alt="First 3d printed prototype attachment" />
<img style="height: 512px; width: 512px;" src="./images/3dInsertSecond.jpg" alt="Second 3d printed prototype attachment" />
<p>
This resulted in the final version that got mounted to our little robot like this.
</p>
<img style="height: 512px; width: 512px;" src="./images/insertMounted.jpg" alt="Second 3d printed prototype attachment" />
<p>
This attachement also gives a bit of tough image to our robo, cool stuff.
</p>
</div>
<div class="blog-entry">
<h2>Power glitches are not nice</h2>
<p>Strange things were happening during testing. At random times the Arduino Uno that controls the servos suddenly stopped its program and halted.
After a lot of scratching of the sparsely populated head, I started some measurements on the power voltage of the Arduino Uno.
Turns out at some points when the steering servo was turning glitches on the power voltage dropped nearly 0.8 volts. Not good !
What I then did was to add an additional dc to dc converter that just feeds the steering servo. After some more testing that solved the issue. Happy days.
</p>
</div>
<div class="blog-entry">
<h2>Testing Time of Flight with black paint</h2>
<p>Since some knowledgable people a the Dutch robotics club voiced their opinion that a time of flight sensor would not work on a black surface, I got worried. I made a small prototype painted black board of wood painted with mat black spray paint and tried the time of flight sensor on it.
</p>
<img style="height: 512px; width: 512px;" src="./images/blackboard.JPG" alt="Mat black painted test board" />
<p>The nice test result is that the tof sensor worked as well on this black surface as on the white test boards I had been using. So 'no worries' as they would say in Australia.
</p>
</div>

<p>V1.0 (c) Rob vd Ouderaa (rouderaa@hccnet.nl)</p>

</body>
</html>
